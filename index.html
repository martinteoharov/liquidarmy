<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>‚öî LIQUID WARS ‚öî - Medieval Battlefield Strategy</title>
        <style>
            /* Medieval 2000s Web Design */
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Times New Roman", "Palatino", serif;
                background: #1a0f0a;
                color: #e8d4a8;
                overflow-x: hidden;
                background-image:
                    radial-gradient(
                        circle at 20% 30%,
                        rgba(139, 90, 43, 0.1) 0%,
                        transparent 50%
                    ),
                    radial-gradient(
                        circle at 80% 70%,
                        rgba(101, 67, 33, 0.1) 0%,
                        transparent 50%
                    );
            }

            /* Animated background particles */
            #particles {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1;
            }

            .particle {
                position: absolute;
                width: 4px;
                height: 4px;
                background: #8b5a2b;
                border-radius: 50%;
                opacity: 0.3;
                animation: float 20s infinite ease-in-out;
            }

            @keyframes float {
                0%,
                100% {
                    transform: translate(0, 0) rotate(0deg);
                }
                25% {
                    transform: translate(10px, -10px) rotate(90deg);
                }
                50% {
                    transform: translate(-10px, -20px) rotate(180deg);
                }
                75% {
                    transform: translate(-20px, -10px) rotate(270deg);
                }
            }

            /* Main container */
            #website {
                position: relative;
                z-index: 2;
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                display: block;
            }

            /* Game canvas container - embedded on page */
            #gameCanvasContainer {
                position: relative;
                width: 100%;
                max-width: 900px;
                margin: 30px auto;
                background: #000;
                border: 6px ridge #654321;
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.7);
            }

            #gameCanvas {
                position: relative;
                width: 100%;
                height: 0;
                padding-bottom: 75%; /* 4:3 aspect ratio */
                background: #000;
            }

            #gameCanvas canvas {
                position: absolute !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
            }

            #canvasOverlay {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 10;
                transition: opacity 0.3s;
            }

            #canvasOverlay:hover {
                background: rgba(0, 0, 0, 0.5);
            }

            #canvasOverlay p {
                color: #c9a668;
                font-size: 24px;
                font-weight: bold;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            }

            #canvasOverlay.hidden {
                display: none;
            }

            /* Fullscreen mode */
            #gameCanvasContainer.fullscreen {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                max-width: none;
                margin: 0;
                border: none;
                border-radius: 0;
                z-index: 9999;
            }

            #gameCanvasContainer.fullscreen #gameCanvas {
                padding-bottom: 0;
                height: 100vh;
            }

            /* Medieval header */
            header {
                text-align: center;
                padding: 40px 20px;
                background: linear-gradient(180deg, #2d1810 0%, #1a0f0a 100%);
                border: 8px ridge #8b5a2b;
                border-radius: 15px;
                margin-bottom: 30px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                position: relative;
            }

            header::before,
            header::after {
                content: "‚öî";
                position: absolute;
                top: 20px;
                font-size: 48px;
                color: #c9a668;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            }

            header::before {
                left: 30px;
            }
            header::after {
                right: 30px;
            }

            h1 {
                font-size: 64px;
                color: #c9a668;
                text-shadow:
                    3px 3px 0 #654321,
                    6px 6px 10px rgba(0, 0, 0, 0.8);
                letter-spacing: 4px;
                margin-bottom: 10px;
                animation: glow 2s ease-in-out infinite alternate;
            }

            @keyframes glow {
                from {
                    text-shadow:
                        3px 3px 0 #654321,
                        6px 6px 10px rgba(0, 0, 0, 0.8);
                }
                to {
                    text-shadow:
                        3px 3px 0 #654321,
                        6px 6px 20px rgba(201, 166, 104, 0.6),
                        0 0 30px rgba(255, 215, 0, 0.4);
                }
            }

            .subtitle {
                font-size: 24px;
                color: #b8944a;
                font-style: italic;
                margin-top: 10px;
            }

            /* Navigation banner */
            nav {
                background: #3d2817;
                border: 4px solid #654321;
                border-radius: 10px;
                padding: 15px;
                margin-bottom: 30px;
                text-align: center;
                box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
            }

            nav a {
                color: #e8d4a8;
                text-decoration: none;
                padding: 10px 20px;
                margin: 0 10px;
                display: inline-block;
                background: #654321;
                border: 2px outset #8b5a2b;
                border-radius: 5px;
                font-weight: bold;
                transition: all 0.2s;
            }

            nav a:hover {
                background: #8b5a2b;
                border-style: inset;
                transform: translateY(2px);
            }

            /* Content sections */
            .content-box {
                background: #2d1810;
                border: 6px ridge #654321;
                border-radius: 10px;
                padding: 30px;
                margin-bottom: 30px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            }

            h2 {
                font-size: 36px;
                color: #c9a668;
                border-bottom: 3px solid #654321;
                padding-bottom: 10px;
                margin-bottom: 20px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            }

            h3 {
                font-size: 24px;
                color: #b8944a;
                margin-top: 20px;
                margin-bottom: 10px;
            }

            p,
            li {
                font-size: 18px;
                line-height: 1.8;
                margin-bottom: 15px;
            }

            ul {
                list-style: none;
                padding-left: 20px;
            }

            ul li::before {
                content: "‚öî ";
                color: #8b5a2b;
                font-weight: bold;
            }

            /* Game configuration section */
            .game-config {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin: 20px 0;
            }

            .config-group {
                background: #1a0f0a;
                border: 3px solid #654321;
                border-radius: 8px;
                padding: 20px;
            }

            .config-group label {
                display: block;
                font-size: 18px;
                font-weight: bold;
                color: #c9a668;
                margin-bottom: 10px;
            }

            select,
            input {
                width: 100%;
                padding: 10px;
                font-size: 16px;
                font-family: "Times New Roman", serif;
                background: #3d2817;
                color: #e8d4a8;
                border: 2px solid #654321;
                border-radius: 5px;
                cursor: pointer;
            }

            select:hover,
            input:hover {
                background: #4d3827;
            }

            /* Team color previews */
            .team-colors {
                display: flex;
                gap: 10px;
                margin-top: 10px;
            }

            .color-box {
                width: 40px;
                height: 40px;
                border: 3px solid #654321;
                border-radius: 5px;
                cursor: pointer;
                transition: transform 0.2s;
            }

            .color-box:hover {
                transform: scale(1.2);
                border-color: #c9a668;
            }

            .color-box.selected {
                border: 4px solid #ffd700;
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
            }

            /* Start game button */
            .start-button {
                display: block;
                width: 100%;
                max-width: 400px;
                margin: 30px auto;
                padding: 20px 40px;
                font-size: 32px;
                font-weight: bold;
                font-family: "Times New Roman", serif;
                color: #fff;
                background: linear-gradient(180deg, #8b0000 0%, #5d0000 100%);
                border: 6px outset #a52a2a;
                border-radius: 10px;
                cursor: pointer;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
                transition: all 0.2s;
            }

            .start-button:hover {
                background: linear-gradient(180deg, #a50000 0%, #6d0000 100%);
                transform: translateY(-2px);
                box-shadow: 0 12px 25px rgba(0, 0, 0, 0.7);
            }

            .start-button:active {
                border-style: inset;
                transform: translateY(2px);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.6);
            }

            /* Footer */
            footer {
                text-align: center;
                padding: 20px;
                background: #1a0f0a;
                border-top: 3px solid #654321;
                margin-top: 40px;
                font-size: 14px;
                color: #8b5a2b;
            }

            /* Scrollbar styling */
            ::-webkit-scrollbar {
                width: 12px;
            }

            ::-webkit-scrollbar-track {
                background: #1a0f0a;
                border: 1px solid #654321;
            }

            ::-webkit-scrollbar-thumb {
                background: #654321;
                border-radius: 6px;
            }

            ::-webkit-scrollbar-thumb:hover {
                background: #8b5a2b;
            }

            /* Blink effect for nostalgic 90s feel */
            .blink {
                animation: blinker 1.5s linear infinite;
            }

            @keyframes blinker {
                50% {
                    opacity: 0.3;
                }
            }

            /* Medieval divider */
            .divider {
                text-align: center;
                margin: 30px 0;
                color: #654321;
                font-size: 24px;
            }

            /* Hidden class */
            .hidden {
                display: none !important;
            }

            /* Game tip text */
            .game-tip {
                text-align: center;
                margin-top: 20px;
                font-style: italic;
                color: #8b5a2b;
                font-size: 16px;
            }
        </style>
    </head>
    <body>
        <!-- Animated background particles -->
        <div id="particles"></div>

        <!-- Website content -->
        <div id="website">
            <!-- Header -->
            <header>
                <h1>‚öî LIQUID WARS ‚öî</h1>
                <p class="subtitle">Command Your Liquid Army to Victory!</p>
            </header>

            <!-- Game Section - Wave Survival -->
            <section id="play" class="content-box">
                <h2>‚öî Wave Survival Mode ‚öî</h2>
                <p style="text-align: center; margin-bottom: 30px">
                    Command the
                    <strong style="color: #e74c3c">Red Legion</strong> and
                    survive endless waves of enemies! <br />Each wave brings
                    stronger foes. How long can you last?
                </p>

                <div class="game-config">
                    <!-- Difficulty Selection -->
                    <div class="config-group">
                        <label for="difficultySelect">üíÄ Difficulty:</label>
                        <select id="difficultySelect">
                            <option value="easy">
                                Easy - More time, weaker enemies
                            </option>
                            <option value="medium" selected>
                                Medium - Balanced challenge
                            </option>
                            <option value="hard">Hard - Fast & deadly</option>
                        </select>
                    </div>

                    <!-- Army Size -->
                    <div class="config-group">
                        <label for="armySize">üõ°Ô∏è Your Army Size:</label>
                        <select id="armySize">
                            <option value="50">50 Warriors</option>
                            <option value="80" selected>80 Warriors</option>
                            <option value="120">120 Warriors</option>
                            <option value="150">150 Warriors</option>
                        </select>
                    </div>
                </div>

                <!-- Start Button -->
                <button class="start-button" onclick="startGame()">
                    ‚öî BEGIN SURVIVAL ‚öî
                </button>

                <!-- Game Canvas Container -->
                <div id="gameCanvasContainer">
                    <main id="gameCanvas"></main>
                    <div id="canvasOverlay">
                        <p>Click to play fullscreen</p>
                    </div>
                </div>

                <p class="game-tip">
                    üí° Move your mouse to control your army ‚Ä¢ Click canvas for
                    fullscreen
                </p>
            </section>

            <!-- Footer -->
            <footer>
                <p>Created by ogip & msteohrv ‚Ä¢ Built with p5.js</p>
            </footer>
        </div>

        <!-- Scripts -->
        <script>
            // Game configuration
            let selectedDifficulty = "medium";
            let selectedArmySize = 80;

            // Create background particles
            function createParticles() {
                const container = document.getElementById("particles");
                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement("div");
                    particle.className = "particle";
                    particle.style.left = Math.random() * 100 + "%";
                    particle.style.top = Math.random() * 100 + "%";
                    particle.style.animationDelay = Math.random() * 20 + "s";
                    particle.style.animationDuration =
                        15 + Math.random() * 10 + "s";
                    container.appendChild(particle);
                }
            }

            // Update config values
            document
                .getElementById("difficultySelect")
                .addEventListener("change", (e) => {
                    selectedDifficulty = e.target.value;
                });

            document
                .getElementById("armySize")
                .addEventListener("change", (e) => {
                    selectedArmySize = parseInt(e.target.value);
                });

            // Start game function
            function startGame() {
                // Pass configuration to sketch.js BEFORE loading
                window.gameConfig = {
                    difficulty: selectedDifficulty,
                    armySize: selectedArmySize,
                    startFromWebsite: true,
                    embeddedMode: true,
                };

                console.log("Starting game with config:", window.gameConfig);

                // Load sketch if not loaded yet
                if (!window.sketchLoaded) {
                    loadSketchAndStart();
                } else {
                    // If already loaded, just restart the game
                    if (typeof window.restartGame === "function") {
                        window.restartGame();
                    }
                }

                // Hide the overlay after game starts
                setTimeout(() => {
                    const overlay = document.getElementById("canvasOverlay");
                    if (overlay) {
                        overlay.classList.add("hidden");
                    }
                }, 500);
            }

            // Toggle fullscreen for canvas
            function toggleFullscreen() {
                const container = document.getElementById(
                    "gameCanvasContainer",
                );

                if (
                    !document.fullscreenElement &&
                    !document.webkitFullscreenElement
                ) {
                    // Enter fullscreen
                    container.classList.add("fullscreen");

                    if (container.requestFullscreen) {
                        container.requestFullscreen();
                    } else if (container.webkitRequestFullscreen) {
                        container.webkitRequestFullscreen();
                    } else if (container.msRequestFullscreen) {
                        container.msRequestFullscreen();
                    }
                } else {
                    // Exit fullscreen
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                }
            }

            // Load p5.js first, then game
            function loadSketchAndStart() {
                console.log("Loading p5.js...");

                // Load p5.js first
                const p5Script = document.createElement("script");
                p5Script.src = "/p5.min.js";
                p5Script.onload = function () {
                    console.log("p5.js loaded, now loading game...");
                    console.log("p5 available:", typeof p5 !== "undefined");
                    console.log("gameConfig set:", window.gameConfig);

                    // Now load game module
                    const gameScript = document.createElement("script");
                    gameScript.type = "module";
                    gameScript.src = "/game.js";
                    gameScript.onload = function () {
                        window.sketchLoaded = true;
                        console.log("Game loaded successfully");

                        // Debug: Check canvas after a moment
                        setTimeout(() => {
                            console.log("Checking canvas...");
                            const canvas =
                                document.querySelector("#gameCanvas canvas");
                            console.log("Canvas element found:", canvas);
                            if (canvas) {
                                console.log(
                                    "Canvas size:",
                                    canvas.width,
                                    "x",
                                    canvas.height,
                                );
                            }
                        }, 1000);
                    };
                    gameScript.onerror = function () {
                        console.error("Failed to load game");
                        alert(
                            "Failed to load game. Please refresh the page and try again.",
                        );
                    };
                    document.body.appendChild(gameScript);
                };
                p5Script.onerror = function () {
                    console.error("Failed to load p5.js");
                    alert(
                        "Failed to load p5.js. Please refresh the page and try again.",
                    );
                };
                document.body.appendChild(p5Script);
            }

            // Listen for fullscreen exit
            document.addEventListener("fullscreenchange", () => {
                const container = document.getElementById(
                    "gameCanvasContainer",
                );
                if (!document.fullscreenElement && container) {
                    container.classList.remove("fullscreen");
                }
            });

            document.addEventListener("webkitfullscreenchange", () => {
                const container = document.getElementById(
                    "gameCanvasContainer",
                );
                if (!document.webkitFullscreenElement && container) {
                    container.classList.remove("fullscreen");
                }
            });

            // Add click listener to canvas overlay to start game
            document.addEventListener("DOMContentLoaded", () => {
                const overlay = document.getElementById("canvasOverlay");
                if (overlay) {
                    overlay.addEventListener("click", () => {
                        startGame();
                    });
                }

                // Add click listener to canvas for fullscreen toggle (after game starts)
                const canvasContainer = document.getElementById("gameCanvas");
                if (canvasContainer) {
                    canvasContainer.addEventListener("click", (e) => {
                        // Only toggle fullscreen if game is running (overlay is hidden)
                        const overlay =
                            document.getElementById("canvasOverlay");
                        if (overlay && overlay.classList.contains("hidden")) {
                            toggleFullscreen();
                        }
                    });
                }
            });

            // Initialize
            createParticles();
        </script>
    </body>
</html>
